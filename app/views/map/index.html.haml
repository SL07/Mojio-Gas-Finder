:javascript

  $(document).ready(function(){
    mojio_client = new MojioClient(config);

    mojioAuthentication();

    isLoggedIn = mojio_client.isLoggedIn();
 

  });  
  
  //var App, MojioClient, config, mojio_client; //some variables needed to initialize data 
  var Current_marker = null;
  var count;
  var testLat = 49.25; 
  var testLong = -123.1;

  localStorage["correctFuelLevel"] = 65;  //random number to initialize, will be over written 

  var gasStationAddress= "7282 Knight St, Vancouver";
  var geocoder;
  var map;
  var directionsDisplay;
  var directionsService = new google.maps.DirectionsService();
  
  var lowFuelWarningdisplayed = false;
  /*
  config = {
            application: '434f01ce-504b-4f72-a919-5a81dee7d506', // Fill in your app id here!
            redirect_uri: 'https://mojio.herokuapp.com/map', // Fill in you redirect uri here! (Ex. 'http://localhost:4093/index.html')
            hostname: 'api.moj.io',
            version: 'v1',
            port: '443',
            scheme: 'https',
            live: false // This will connect your app to the sandbox environment, change it to true to go live. 
        };
  */
        
    /*   
    if (localStorage["mojio_token"] == null){
       console.log("localStorge not made yet, need to login");   
    }
    else{
    //clear previous token then set new one
    //localStorage.removeItem("lastname"); syntax to clear localStorage
    console.log("value of token is: " + localStorage["mojio_token"]);
    mojio_client.auth_token = JSON.parse(localStorage["mojio_token"]); //need to destring before passing in
    } 
    */
function mojioAuthentication(){
  if (mojio_client.isLoggedIn() == false){  //use this to test for login status
      console.log("checking for login token");
              mojio_client.token(function(error, result) {
                  if (error) {
                      console.log(error);
                     // alert("Authorize Redirect, token could not be retreived:" + error); //take out later 
                  } else {
                    //  alert("Authorization Successful.");   //taken out for video demo
                      div = $("#welcome");
                      div.html('Authorization Result:');
                      div.append(JSON.stringify(result));
                      console.log(JSON.stringify(result));
                      //localStorage.removeItem["mojio_token"]; //clears the token before appending a new one
                      sessionStorage["mojio_token"] = JSON.stringify(result);  //save the token into local storage
                      getVehicleData(); //update all long, lat and fuel level data on first load
                  }
              });
              console.log("value of token is: " + sessionStorage["mojio_token"]);
              mojio_client.auth_token = JSON.parse(sessionStorage["mojio_token"]); //need to destring before passing in

  }
  else if(mojio_client.isLoggedIn() == true){
    console.log("already logged in to Mojio");
    console.log("value of token is: " + sessionStorage["mojio_token"]);

  }  
}

 
  
  
.container-fluid   
  %h1 Map
  #basicModal.modal.fade{"aria-hidden" => "true", "aria-labelledby" => "basicModal", :role => "dialog", :tabindex => "-1"}

  .modal.fade
  .modal-dialog
    .modal-content
      .modal-header
        %button.close{"aria-label" => "Close", "data-dismiss" => "modal", :type => "button"}
          %span{"aria-hidden" => "true"} Ã—
        //%h4.modal-title Modal Warning !
        %h3#myModalLabel.modal-title{:style => "color:white"} Warning!
      .modal-body
        //%p Gas Level Below
        %h4{:style => "color:white"} Gas Level Below 15%.
      .modal-footer
        %button.btn.btn-default{"data-dismiss" => "modal", :type => "button"} Close

  #map
  %p
    Fuel level:
    #fuelDisplay
  %p
    #ResultField
  %P
  #directions-panel
  #control

  
  #accordion.panel-group{"aria-multiselectable" => "true", :role => "tablist"}
  .panel.panel-default.col-md-3
    #headingOne.panel-heading{:role => "tab"}
      %h4.panel-title
        %a.collapsed{"aria-controls" => "collapseOne", "aria-expanded" => "false", "data-parent" => "#accordion", "data-toggle" => "collapse", :href => "#collapseOne"}
          Find Closest Station
    #collapseOne.panel-collapse.collapse{"aria-labelledby" => "headingOne", :role => "tabpanel"}
      .panel-body
        %h4 Preference:
        %h5 Fuel Type:
        .btn-inline{"data-toggle" => "buttons"}
          %label#regular.btn.btn-primary{:style => "margin-top:5px"}
            %input#regular{:autocomplete => "off", :checked => "checked", :name => "options", :type => "radio"}/
            Regular
          %label#midGrade.btn.btn-primary{:style => "margin-top:5px"}
            %input#midGrade{:autocomplete => "off", :name => "options", :type => "radio"}/
            Mid-Grade
          %label#premium.btn.btn-primary{:style => "margin-top:5px"}
            %input#premium{:autocomplete => "off", :name => "options", :type => "radio"}/
            Premium
          %label#diesel.btn.btn-primary{:style => "margin-top:5px"}
            %input#diesel{:autocomplete => "off", :name => "options", :type => "radio"}/
            Diesel
        %input.pull-right.btn.btn-default{:type => "button", :value => "Search", :onClick => "getClosest()"}
              
  .panel.panel-default.col-md-3.col-md-offset-1
    #headingTwo.panel-heading{:role => "tab"}
      %h4.panel-title
        %a.collapsed{"aria-controls" => "collapseTwo", "aria-expanded" => "false", "data-parent" => "#accordion", "data-toggle" => "collapse", :href => "#collapseTwo"}
          Find Cheapest Station
    #collapseTwo.panel-collapse.collapse{"aria-labelledby" => "headingTwo", :role => "tabpanel"}
      .panel-body
        %h4 Preference:
        %h5 Fuel Type:
        .btn-inline{"data-toggle" => "buttons"}
          %label#regular.btn.btn-primary{:style => "margin-top:5px"}
            %input#regular{:autocomplete => "off", :checked => "checked", :name => "options", :type => "radio"}/
            Regular
          %label#midGrade.btn.btn-primary{:style => "margin-top:5px"}
            %input#midGrade{:autocomplete => "off", :name => "options", :type => "radio"}/
            Mid-Grade
          %label#premium.btn.btn-primary{:style => "margin-top:5px"}
            %input#premium{:autocomplete => "off", :name => "options", :type => "radio"}/
            Premium
          %label#diesel.btn.btn-primary{:style => "margin-top:5px"}
            %input#diesel{:autocomplete => "off", :name => "options", :type => "radio"}/
            Diesel
        %h5 Search Range (km):
        .btn{"data-toggle" => "buttons"}
          %label#range_1.btn.btn-primary
            %input#range_1{:autocomplete => "off", :checked => "checked", :name => "options", :type => "radio"}/
            1
          %label#range_2.btn.btn-primary
            %input#range_2{:autocomplete => "off", :name => "options", :type => "radio"}/
            2
          %label#range_5.btn.btn-primary
            %input#range_5{:autocomplete => "off", :name => "options", :type => "radio"}/
            5
          %label#range_0.btn.btn-primary
            %input#range_0{:autocomplete => "off", :name => "options", :type => "radio"}/
            10 
        %input.pull-right.btn.btn-default{:type => "button", :value => "Search", :onClick => "getCheapest()"}


  
